<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#4f46e5">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>AI Interview Chat</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
        body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:#f9fafb;height:100vh;overflow:hidden}
        
        /* App Container */
        .app{display:flex;flex-direction:column;height:100vh;height:100dvh;position:relative}
        
        /* Top Bar */
        .top-bar{background:linear-gradient(135deg,#4f46e5,#9333ea);color:#fff;padding:env(safe-area-inset-top) 1rem 1rem;box-shadow:0 2px 10px rgba(79,70,229,.3);position:relative;z-index:10}
        .top-content{display:flex;align-items:center;gap:.75rem}
        .back-btn{background:rgba(255,255,255,.2);border:none;width:36px;height:36px;border-radius:50%;font-size:1.25rem;display:flex;align-items:center;justify-content:center;cursor:pointer;backdrop-filter:blur(10px)}
        .back-btn:active{background:rgba(255,255,255,.3);transform:scale(.95)}
        .top-info{flex:1}
        .top-title{font-size:1rem;font-weight:700;margin-bottom:.125rem}
        .top-subtitle{font-size:.75rem;opacity:.9;display:flex;align-items:center;gap:.5rem}
        .status-dot{width:6px;height:6px;background:#22c55e;border-radius:50%;animation:pulse 2s infinite}
        @keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}
        .top-actions{display:flex;gap:.5rem}
        .icon-btn{background:rgba(255,255,255,.2);border:none;width:36px;height:36px;border-radius:50%;font-size:1.125rem;display:flex;align-items:center;justify-content:center;cursor:pointer;backdrop-filter:blur(10px)}
        .icon-btn:active{background:rgba(255,255,255,.3);transform:scale(.95)}
        
        /* AI Character Card */
        .ai-card{background:#fff;margin:.75rem;padding:1rem;border-radius:1.25rem;box-shadow:0 2px 12px rgba(0,0,0,.08);display:flex;align-items:center;gap:1rem;position:relative}
        .ai-emoji{font-size:4rem;animation:float 3s ease-in-out infinite;cursor:pointer;user-select:none}
        @keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-8px)}}
        .ai-info{flex:1}
        .ai-name{font-size:1.125rem;font-weight:700;color:#1f2937;margin-bottom:.25rem}
        .ai-status{font-size:.75rem;color:#6b7280;display:flex;align-items:center;gap:.5rem}
        .mood-indicator{padding:.25rem .625rem;background:linear-gradient(135deg,#dbeafe,#bfdbfe);border-radius:.5rem;font-size:.625rem;font-weight:600;color:#1e40af}
        .progress-mini{margin-top:.5rem}
        .progress-label{font-size:.625rem;color:#9ca3af;margin-bottom:.25rem;display:flex;justify-content:space-between}
        .progress-track{height:4px;background:#e5e7eb;border-radius:2px;overflow:hidden}
        .progress-fill{height:100%;background:linear-gradient(90deg,#4f46e5,#9333ea);transition:width .5s;border-radius:2px}
        
        /* Quick Stats */
        .quick-stats{display:flex;padding:0 .75rem .75rem;gap:.5rem;overflow-x:auto}
        .quick-stats::-webkit-scrollbar{display:none}
        .stat-pill{flex-shrink:0;background:#fff;padding:.625rem 1rem;border-radius:1rem;box-shadow:0 2px 8px rgba(0,0,0,.06);text-align:center;min-width:70px}
        .stat-pill.highlight{background:linear-gradient(135deg,#eef2ff,#e0e7ff)}
        .stat-value{font-size:1.125rem;font-weight:800;color:#4f46e5;margin-bottom:.125rem}
        .stat-label{font-size:.625rem;color:#6b7280;font-weight:600}
        
        /* Messages Container */
        .messages-container{flex:1;overflow-y:auto;padding:0 .75rem;padding-bottom:.75rem;scroll-behavior:smooth}
        .messages-container::-webkit-scrollbar{display:none}
        .date-divider{text-align:center;margin:1rem 0;font-size:.625rem;color:#9ca3af;font-weight:600}
        .message-wrapper{margin-bottom:.75rem;animation:slideUp .3s ease-out}
        @keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
        .message{display:flex;gap:.5rem;align-items:flex-end}
        .message.user{flex-direction:row-reverse}
        .avatar{width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.25rem;flex-shrink:0;box-shadow:0 2px 8px rgba(0,0,0,.1)}
        .avatar.ai{background:linear-gradient(135deg,#eef2ff,#e0e7ff)}
        .avatar.user{background:linear-gradient(135deg,#fef3c7,#fde68a)}
        .bubble-container{max-width:80%;display:flex;flex-direction:column}
        .message.user .bubble-container{align-items:flex-end}
        .sender-name{font-size:.625rem;color:#6b7280;font-weight:600;margin-bottom:.25rem;padding:0 .5rem}
        .bubble{padding:.875rem 1.125rem;border-radius:1.25rem;box-shadow:0 2px 8px rgba(0,0,0,.1);position:relative;word-wrap:break-word}
        .message.ai .bubble{background:#fff;border:2px solid #e0e7ff;border-radius:1.25rem 1.25rem 1.25rem .25rem}
        .message.user .bubble{background:linear-gradient(135deg,#4f46e5,#9333ea);color:#fff;border-radius:1.25rem 1.25rem .25rem 1.25rem}
        .bubble-text{font-size:.9375rem;line-height:1.5;margin-bottom:.375rem}
        .bubble-footer{display:flex;align-items:center;justify-content:space-between;gap:.5rem}
        .timestamp{font-size:.625rem;color:#9ca3af}
        .message.user .timestamp{color:rgba(255,255,255,.7)}
        .read-status{font-size:.75rem}
        
        /* Typing Indicator */
        .typing-indicator{display:none;margin-bottom:.75rem}
        .typing-indicator.show{display:flex}
        .typing-bubble{background:#fff;border:2px solid #e0e7ff;padding:.75rem 1rem;border-radius:1.25rem;display:flex;gap:.375rem;align-items:center;box-shadow:0 2px 8px rgba(0,0,0,.1)}
        .typing-dot{width:8px;height:8px;background:#4f46e5;border-radius:50%;animation:typing-bounce .6s infinite}
        .typing-dot:nth-child(2){animation-delay:.2s}
        .typing-dot:nth-child(3){animation-delay:.4s}
        @keyframes typing-bounce{0%,100%{transform:translateY(0)}50%{transform:translateY(-6px)}}
        
        /* Suggestions */
        .suggestions{display:none;padding:0 .75rem .75rem;gap:.5rem;overflow-x:auto}
        .suggestions.show{display:flex}
        .suggestions::-webkit-scrollbar{display:none}
        .suggestion-chip{flex-shrink:0;background:#fff;border:2px solid #e5e7eb;padding:.625rem 1rem;border-radius:1.5rem;font-size:.8125rem;color:#4b5563;font-weight:600;cursor:pointer;white-space:nowrap;box-shadow:0 2px 4px rgba(0,0,0,.05)}
        .suggestion-chip:active{transform:scale(.95);background:#f9fafb}
        
        /* Input Area */
        .input-area{background:#fff;border-top:1px solid #e5e7eb;padding:.75rem;padding-bottom:calc(.75rem + env(safe-area-inset-bottom));box-shadow:0 -2px 10px rgba(0,0,0,.05)}
        .input-wrapper{display:flex;gap:.5rem;align-items:flex-end}
        .input-actions{display:flex;flex-direction:column;gap:.5rem}
        .attach-btn{background:#f3f4f6;border:none;width:40px;height:40px;border-radius:50%;font-size:1.25rem;display:flex;align-items:center;justify-content:center;cursor:pointer}
        .attach-btn:active{background:#e5e7eb;transform:scale(.95)}
        .input-container{flex:1;background:#f3f4f6;border-radius:1.5rem;padding:.625rem 1rem;display:flex;align-items:center;gap:.5rem}
        .input-field{flex:1;background:transparent;border:none;outline:none;font-size:.9375rem;font-family:inherit;resize:none;max-height:100px;min-height:24px}
        .emoji-btn{background:none;border:none;font-size:1.25rem;cursor:pointer;padding:.25rem}
        .send-btn{background:linear-gradient(135deg,#4f46e5,#9333ea);border:none;width:44px;height:44px;border-radius:50%;color:#fff;font-size:1.25rem;display:flex;align-items:center;justify-content:center;cursor:pointer;box-shadow:0 4px 12px rgba(79,70,229,.3);transition:all .2s}
        .send-btn:active{transform:scale(.9);box-shadow:0 2px 8px rgba(79,70,229,.3)}
        .send-btn:disabled{opacity:.5;transform:none}
        
        /* Bottom Sheet */
        .bottom-sheet{position:fixed;bottom:0;left:0;right:0;background:#fff;border-radius:1.5rem 1.5rem 0 0;box-shadow:0 -4px 20px rgba(0,0,0,.15);transform:translateY(100%);transition:transform .3s cubic-bezier(.4,0,.2,1);z-index:100;max-height:80vh;overflow-y:auto;padding-bottom:env(safe-area-inset-bottom)}
        .bottom-sheet.show{transform:translateY(0)}
        .sheet-header{padding:1rem;text-align:center;position:sticky;top:0;background:#fff;z-index:1}
        .sheet-handle{width:36px;height:4px;background:#d1d5db;border-radius:2px;margin:0 auto .75rem}
        .sheet-title{font-size:1.125rem;font-weight:700;color:#1f2937}
        .sheet-content{padding:0 1rem 1rem}
        .menu-item{display:flex;align-items:center;gap:1rem;padding:1rem;border-radius:.75rem;margin-bottom:.5rem;cursor:pointer;transition:background .2s}
        .menu-item:active{background:#f3f4f6}
        .menu-icon{width:44px;height:44px;border-radius:.75rem;display:flex;align-items:center;justify-content:center;font-size:1.5rem;background:linear-gradient(135deg,#eef2ff,#e0e7ff)}
        .menu-text{flex:1}
        .menu-label{font-weight:600;color:#1f2937;display:block;margin-bottom:.125rem}
        .menu-desc{font-size:.75rem;color:#6b7280}
        .menu-divider{height:1px;background:#e5e7eb;margin:1rem 0}
        
        /* Overlay */
        .overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);opacity:0;pointer-events:none;transition:opacity .3s;z-index:99}
        .overlay.show{opacity:1;pointer-events:all}
        
        /* Haptic Feedback Simulation */
        @keyframes haptic{
            0%,100%{transform:scale(1)}
            50%{transform:scale(.98)}
        }
        .haptic{animation:haptic .1s}
    </style>
</head>
<body>
    <div class="app">
        <!-- Top Bar -->
        <div class="top-bar">
            <div class="top-content">
                <button class="back-btn" onclick="goBack()">‚Üê</button>
                <div class="top-info">
                    <div class="top-title">AI Interviewer</div>
                    <div class="top-subtitle">
                        <span class="status-dot"></span>
                        <span id="statusText">Active & Listening</span>
                    </div>
                </div>
                <div class="top-actions">
                    <button class="icon-btn" onclick="showInfo()">‚ÑπÔ∏è</button>
                    <button class="icon-btn" onclick="showMenu()">‚ãÆ</button>
                </div>
            </div>
        </div>

        <!-- AI Character Card -->
        <div class="ai-card">
            <div class="ai-emoji" id="aiEmoji" onclick="emojiTap()">ü§ñ</div>
            <div class="ai-info">
                <div class="ai-name">Your AI Interviewer</div>
                <div class="ai-status">
                    <span class="mood-indicator" id="moodText">üòä Happy</span>
                </div>
                <div class="progress-mini">
                    <div class="progress-label">
                        <span>Interview Progress</span>
                        <span id="progressText">75%</span>
                    </div>
                    <div class="progress-track">
                        <div class="progress-fill" id="progressBar" style="width:75%"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quick Stats -->
        <div class="quick-stats">
            <div class="stat-pill highlight">
                <div class="stat-value" id="msgCount">12</div>
                <div class="stat-label">Messages</div>
            </div>
            <div class="stat-pill">
                <div class="stat-value" id="timeCount">8m</div>
                <div class="stat-label">Duration</div>
            </div>
            <div class="stat-pill">
                <div class="stat-value" id="scoreCount">94</div>
                <div class="stat-label">Score</div>
            </div>
            <div class="stat-pill">
                <div class="stat-value">7/10</div>
                <div class="stat-label">Questions</div>
            </div>
        </div>

        <!-- Messages Container -->
        <div class="messages-container" id="messages">
            <div class="date-divider">Today, 2:30 PM</div>
            <!-- Messages will be rendered here -->
        </div>

        <!-- Typing Indicator -->
        <div class="typing-indicator" id="typingIndicator">
            <div class="message">
                <div class="avatar ai">ü§ñ</div>
                <div class="typing-bubble">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
            </div>
        </div>

        <!-- Suggestions -->
        <div class="suggestions" id="suggestions">
            <div class="suggestion-chip" onclick="useSuggestion('Tell me about my experience')">üìù My experience</div>
            <div class="suggestion-chip" onclick="useSuggestion('I need more time to think')">‚è±Ô∏è Need time</div>
            <div class="suggestion-chip" onclick="useSuggestion('Can you rephrase that?')">üîÑ Rephrase</div>
        </div>

        <!-- Input Area -->
        <div class="input-area">
            <div class="input-wrapper">
                <button class="attach-btn" onclick="attachFile()">üìé</button>
                <div class="input-container">
                    <textarea 
                        class="input-field" 
                        id="inputField" 
                        placeholder="Type your answer..."
                        rows="1"
                    ></textarea>
                    <button class="emoji-btn" onclick="showEmojis()">üòä</button>
                </div>
                <button class="send-btn" id="sendBtn" onclick="sendMessage()">‚û§</button>
            </div>
        </div>
    </div>

    <!-- Overlay -->
    <div class="overlay" id="overlay" onclick="hideAll()"></div>

    <!-- Bottom Sheet Menu -->
    <div class="bottom-sheet" id="bottomSheet">
        <div class="sheet-header">
            <div class="sheet-handle"></div>
            <div class="sheet-title">Interview Options</div>
        </div>
        <div class="sheet-content">
            <div class="menu-item" onclick="menuAction('save')">
                <div class="menu-icon" style="background:linear-gradient(135deg,#dcfce7,#bbf7d0)">üíæ</div>
                <div class="menu-text">
                    <span class="menu-label">Save Interview</span>
                    <span class="menu-desc">Save your current progress</span>
                </div>
            </div>
            <div class="menu-item" onclick="menuAction('analytics')">
                <div class="menu-icon" style="background:linear-gradient(135deg,#dbeafe,#bfdbfe)">üìä</div>
                <div class="menu-text">
                    <span class="menu-label">View Analytics</span>
                    <span class="menu-desc">See detailed performance stats</span>
                </div>
            </div>
            <div class="menu-item" onclick="menuAction('hints')">
                <div class="menu-icon" style="background:linear-gradient(135deg,#fef3c7,#fde68a)">üí°</div>
                <div class="menu-text">
                    <span class="menu-label">Get Hints</span>
                    <span class="menu-desc">Need help with your answer?</span>
                </div>
            </div>
            <div class="menu-item" onclick="menuAction('settings')">
                <div class="menu-icon" style="background:linear-gradient(135deg,#e5e7eb,#d1d5db)">‚öôÔ∏è</div>
                <div class="menu-text">
                    <span class="menu-label">Settings</span>
                    <span class="menu-desc">Adjust interview preferences</span>
                </div>
            </div>
            <div class="menu-divider"></div>
            <div class="menu-item" onclick="menuAction('end')">
                <div class="menu-icon" style="background:linear-gradient(135deg,#fee2e2,#fecaca)">üö™</div>
                <div class="menu-text">
                    <span class="menu-label" style="color:#dc2626">End Interview</span>
                    <span class="menu-desc">Finish and review your session</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Sample messages
        let messages=[
            {s:'ai',t:"Hi! I'm excited to interview you today. Let's start with an easy question: Can you tell me about yourself and your background?",time:'2:30 PM'},
            {s:'user',t:"Hi! I'm a software engineer with 5 years of experience. I specialize in React, Node.js, and cloud architecture.",time:'2:31 PM'},
            {s:'ai',t:"That's great! 5 years is solid experience. Can you tell me about a challenging project you worked on recently and how you approached it?",time:'2:31 PM'},
            {s:'user',t:"Sure! I built a real-time collaboration platform that handled 10k+ concurrent users. The biggest challenge was optimizing WebSocket connections.",time:'2:32 PM'},
            {s:'ai',t:"Impressive! How did you handle the scaling challenges with that many concurrent connections?",time:'2:33 PM'}
        ];

        const emojis={happy:'ü§ñ',thinking:'ü§î',excited:'ü§©',impressed:'üòÆ',listening:'üëÇ'};
        const moods={happy:'üòä Happy',thinking:'ü§î Thinking',excited:'ü§© Excited',impressed:'üòÆ Impressed',listening:'üëÇ Listening'};
        const statuses={happy:'Active & Listening',thinking:'Analyzing your answer...',excited:'Great response!',impressed:'Very impressive!',listening:'Waiting for your answer'};

        let currentMood='happy';

        // Render messages
        function renderMessages(){
            const container=document.getElementById('messages');
            const existingDivider=container.querySelector('.date-divider');
            container.innerHTML='';
            if(existingDivider)container.appendChild(existingDivider);

            messages.forEach((msg,idx)=>{
                const wrapper=document.createElement('div');
                wrapper.className='message-wrapper';
                wrapper.style.animationDelay=`${idx*0.05}s`;

                const msgDiv=document.createElement('div');
                msgDiv.className='message '+(msg.s==='user'?'user':'ai');

                const avatar=document.createElement('div');
                avatar.className='avatar '+(msg.s==='user'?'user':'ai');
                avatar.textContent=msg.s==='ai'?'ü§ñ':'üë§';

                const bubbleContainer=document.createElement('div');
                bubbleContainer.className='bubble-container';

                if(msg.s==='ai'){
                    const senderName=document.createElement('div');
                    senderName.className='sender-name';
                    senderName.textContent='AI Interviewer';
                    bubbleContainer.appendChild(senderName);
                }

                const bubble=document.createElement('div');
                bubble.className='bubble';

                const text=document.createElement('div');
                text.className='bubble-text';
                text.textContent=msg.t;

                const footer=document.createElement('div');
                footer.className='bubble-footer';

                const timestamp=document.createElement('div');
                timestamp.className='timestamp';
                timestamp.textContent=msg.time;

                footer.appendChild(timestamp);

                if(msg.s==='user'){
                    const status=document.createElement('div');
                    status.className='read-status';
                    status.textContent='‚úì‚úì';
                    footer.appendChild(status);
                }

                bubble.appendChild(text);
                bubble.appendChild(footer);
                bubbleContainer.appendChild(bubble);

                msgDiv.appendChild(avatar);
                msgDiv.appendChild(bubbleContainer);
                wrapper.appendChild(msgDiv);
                container.appendChild(wrapper);
            });

            container.scrollTop=container.scrollHeight;
        }

        // Update mood
        function setMood(mood){
            currentMood=mood;
            document.getElementById('aiEmoji').textContent=emojis[mood];
            document.getElementById('moodText').textContent=moods[mood];
            document.getElementById('statusText').textContent=statuses[mood];
        }

        // Update stats
        function updateStats(){
            document.getElementById('msgCount').textContent=messages.length;
            const progress=Math.min(messages.length*8,100);
            document.getElementById('progressText').textContent=progress+'%';
            document.getElementById('progressBar').style.width=progress+'%';
        }

        // Get current time
        function getTime(){
            const now=new Date();
            return now.toLocaleTimeString('en-US',{hour:'numeric',minute:'2-digit'});
        }

        // Send message
        function sendMessage(){
            const input=document.getElementById('inputField');
            const text=input.value.trim();
            if(!text)return;

            // Haptic feedback
            document.getElementById('sendBtn').classList.add('haptic');
            setTimeout(()=>document.getElementById('sendBtn').classList.remove('haptic'),100);

            messages.push({s:'user',t:text,time:getTime()});
            input.value='';
            input.style.height='auto';
            renderMessages();
            updateStats();
            
            setMood('thinking');
            document.getElementById('typingIndicator').classList.add('show');
            document.getElementById('suggestions').classList.remove('show');
            document.getElementById('sendBtn').disabled=true;

            const responses=[
                "That's a great point! Can you elaborate on how you implemented that solution?",
                "Interesting approach! What made you choose that particular technology stack?",
                "I see. What were some of the key challenges you faced during implementation?",
                "Excellent! How did you measure the success of that project?",
                "That's impressive! What would you do differently if you could start over?"
            ];

            setTimeout(()=>{
                document.getElementById('typingIndicator').classList.remove('show');
                setMood('excited');
                messages.push({s:'ai',t:responses[Math.floor(Math.random()*responses.length)],time:getTime()});
                renderMessages();
                updateStats();
                document.getElementById('sendBtn').disabled=false;
                document.getElementById('suggestions').classList.add('show');
                setTimeout(()=>setMood('happy'),1500);
            },2000);
        }

        // Auto-resize textarea
        const input=document.getElementById('inputField');
        input.addEventListener('input',function(){
            this.style.height='auto';
            this.style.height=Math.min(this.scrollHeight,100)+'px';
        });

        // Enter to send
        input.addEventListener('keydown',function(e){
            if(e.key==='Enter'&&!e.shiftKey){
                e.preventDefault();
                sendMessage();
            }
        });

        // Show/hide menu
        function showMenu(){
            document.getElementById('bottomSheet').classList.add('show');
            document.getElementById('overlay').classList.add('show');
            document.body.style.overflow='hidden';
        }

        function hideAll(){
            document.getElementById('bottomSheet').classList.remove('show');
            document.getElementById('overlay').classList.remove('show');
            document.body.style.overflow='';
        }

        // Menu actions
        function menuAction(action){
            hideAll();
            alert('Action: '+action);
        }

        // Emoji tap animation
        function emojiTap(){
            const emoji=document.getElementById('aiEmoji');
            emoji.style.transform='scale(1.2) rotate(15deg)';
            setTimeout(()=>emoji.style.transform='scale(1) rotate(0)',200);
        }

        // Use suggestion
        function useSuggestion(text){
            document.getElementById('inputField').value=text;
            document.getElementById('inputField').focus();
            document.getElementById('suggestions').classList.remove('show');
        }

        // Other functions
        function goBack(){
            if(confirm('Are you sure you want to leave this interview?')){
                window.history.back();
            }
        }

        function showInfo(){
            alert('Interview Info:\n\nPosition: Software Engineer\nRound: Technical\nDuration: 8 minutes\nQuestions: 7/10');
        }

        function attachFile(){
            alert('File attachment coming soon!');
        }

        function showEmojis(){
            alert('Emoji picker coming soon! üòä');
        }

        // Prevent zoom
        document.addEventListener('gesturestart',e=>e.preventDefault());

        // Initialize
        renderMessages();
        updateStats();
        setTimeout(()=>document.getElementById('suggestions').classList.add('show'),500);
    </script>
</body>
</html>